{"version":3,"file":"items.component.js","sourceRoot":"","sources":["items.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, ElementRef, OnInit, ViewChild, NgZone, AfterViewInit} from \"@angular/core\";\nimport {Item} from \"../../shared/item/item\";\nimport {ItemService} from \"../../shared/item/item.service\";\nimport {ItemList} from \"../item-list.component\";\nimport {ListService} from \"../../shared/list/list.service\";\nimport {validate} from \"email-validator\";\nimport {AppService} from \"../../app.service\";\nimport {ActivityIndicator} from \"../../components/activity-indicator.component\";\n\n@Component({\n  selector: \"page-items\",\n  templateUrl: \"app/pages/items/items.html\",\n  styleUrls: [\"app/pages/items/items.css\"],\n  directives : [ItemList, ActivityIndicator],\n  providers: [ItemService, ListService]\n})\n\nexport class ItemsPage implements OnInit {\n  itemList: Array<Item> = [];\n  item: string = \"\";\n  email: string = \"\";\n  isLoading = false;\n  listLoaded = false;\n  showShare = false;\n  public listName: string = \"\";\n  private _paramSubscription: any;\n  private _listId: string;\n\n  constructor(\n    private _appService: AppService,\n    private _itemService: ItemService,\n    private _listService: ListService,\n    private _zone: NgZone\n  ) {}\n\n  ngOnInit() {\n    //console.log(\"ItemsPage ngOnInit\");\n    this.isLoading = true;\n\n    this._listId = this._appService.getPageMeta().listId;\n    this._itemService.load(this._listId)\n      .subscribe(response => {\n          this.listName = response.name;\n          response.items.forEach((itemObject) => {\n              this.itemList.unshift(itemObject);\n          });\n\n          //////console.log(this.itemList);\n          this.isLoading = false;\n          this.listLoaded = true;\n      });\n  }\n\n  hideLoadingIndicator() {\n    this.isLoading = false;\n  }\n\n  back() {\n    this._appService.setPage(\"list\", {});\n  }\n\n  shareToggle() {\n    //////console.log(\"do shareToggle\");\n    this._zone.run(() => {\n        this.showShare = !this.showShare;\n    });\n  }\n\n  toggleDone(item: Item) {\n    //////console.log(\"items.component toggleDone\", item);\n\n    this._itemService.done(item.id, this._listId, item.done)\n      .subscribe(\n        responseSuccess => {},\n        () => {\n          alert(\"An error occurred changing the done status of an item in your list.\");\n        }\n      )\n  }\n\n  share() {\n    //////console.log(\"do share...\");\n\n    if (!validate(this.email)) {\n      alert(\"Enter a valid email address.\");\n      return;\n    }\n\n    this._listService.share(this._listId, this.email)\n      .subscribe(\n        response => {\n          alert(response.message);\n\n          if (response.success) {\n            this._zone.run(() => {\n                this.email = \"\";\n            });\n          }\n        },\n        (error) => {\n          //////console.log(\"error\", error);\n          alert(\"An error occurred sharing your list.\");\n        }\n      )\n  }\n\n  add() {\n    this._itemService.add(this.item, this._listId)\n      .subscribe(\n        itemObject => {\n            // Running the change detection in a zone ensures that change\n            // detection gets triggered if needed.\n            this._zone.run(() => {\n                this.item = \"\";\n                this.itemList.unshift(itemObject);\n            });\n        },\n        () => {\n          alert({\n            message: \"An error occurred while adding an item to your list.\",\n            okButtonText: \"OK\"\n          });\n        }\n      )\n  }\n\n  delete(item) {\n    this._itemService.delete(item.id, this._listId)\n      .subscribe(\n        responseSuccess => {\n          // Running the change detection in a zone ensures that change\n          // detection gets triggered if needed.\n          this._zone.run(() => {\n            this.itemList.splice(item.index, 1);\n          });\n        },\n        () => {\n          this._zone.run(() => {\n            this.itemList.splice(item.index, 1);\n          });\n          // for some reason this works but is throwing an error...\n          //alert(\"An error occurred while deleting an item from your list.\");\n        }\n      )\n  }\n}"]}